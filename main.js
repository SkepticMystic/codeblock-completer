/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __markAsModule = (target) => __defProp(target, "__esModule", { value: true });
var __export = (target, all) => {
  __markAsModule(target);
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __reExport = (target, module2, desc) => {
  if (module2 && typeof module2 === "object" || typeof module2 === "function") {
    for (let key of __getOwnPropNames(module2))
      if (!__hasOwnProp.call(target, key) && key !== "default")
        __defProp(target, key, { get: () => module2[key], enumerable: !(desc = __getOwnPropDesc(module2, key)) || desc.enumerable });
  }
  return target;
};
var __toModule = (module2) => {
  return __reExport(__markAsModule(__defProp(module2 != null ? __create(__getProtoOf(module2)) : {}, "default", module2 && module2.__esModule && "default" in module2 ? { get: () => module2.default, enumerable: true } : { value: module2, enumerable: true })), module2);
};

// src/main.ts
__export(exports, {
  default: () => CCPlugin
});
var import_obsidian3 = __toModule(require("obsidian"));

// src/const.ts
var DEFAULT_SETTINGS = {
  customTypes: []
};

// src/SettingTab.ts
var import_obsidian = __toModule(require("obsidian"));

// src/utils.ts
var splitAndTrim = (fields) => {
  if (!fields || fields === "")
    return [];
  else
    return fields.split(",").map((str) => str.trim());
};

// src/SettingTab.ts
var SettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    let { containerEl, plugin } = this;
    const { settings } = plugin;
    containerEl.empty();
    new import_obsidian.Setting(containerEl).setName("Custom Codeblocks").setDesc("A comma-separated list of codeblocks types to suggest (aside from those added by your plugins).").addText((text) => {
      text.setValue(settings.customTypes.join(", "));
      text.inputEl.onblur = async () => {
        const value = text.getValue();
        settings.customTypes = splitAndTrim(value);
        await plugin.saveSettings();
      };
    });
  }
};

// src/Suggester.ts
var import_obsidian2 = __toModule(require("obsidian"));
var CodeblockSuggester = class extends import_obsidian2.EditorSuggest {
  constructor(plugin) {
    super(plugin.app);
    this.getSuggestions = (context) => {
      const { query } = context;
      const fromPlugins = Object.keys(import_obsidian2.MarkdownPreviewRenderer.codeBlockPostProcessors);
      return [...this.plugin.settings.customTypes, ...fromPlugins].filter((sug) => sug.includes(query));
    };
    this.plugin = plugin;
  }
  onTrigger(cursor, editor, _) {
    const sub = editor.getLine(cursor.line).substring(0, cursor.ch);
    const match = sub.match(/^```(.*)$/)?.[1];
    if (match !== void 0) {
      return {
        start: {
          ch: sub.lastIndexOf(match),
          line: cursor.line
        },
        end: cursor,
        query: match
      };
    }
    return null;
  }
  renderSuggestion(suggestion, el) {
    el.createDiv({
      text: suggestion,
      cls: "codeblock-suggestion"
    });
  }
  addLineBreak(end, ed) {
    const nextLine = ed.getLine(end.line + 1);
    console.log(nextLine);
    return nextLine === "```" || nextLine === "" || nextLine === "\n" ? "\n\n" : "";
  }
  selectSuggestion(suggestion) {
    const { context, addLineBreak } = this;
    if (context) {
      const { start, end, editor } = context;
      const replacement = `\`\`\`${suggestion}${addLineBreak(end, editor)}`;
      editor.replaceRange(replacement, { ch: 0, line: start.line }, end);
      editor.setCursor({ ch: 0, line: end.line + 1 });
    }
  }
};

// src/main.ts
var CCPlugin = class extends import_obsidian3.Plugin {
  async onload() {
    await this.loadSettings();
    this.addSettingTab(new SettingTab(this.app, this));
    this.registerEditorSuggest(new CodeblockSuggester(this));
  }
  onunload() {
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL2NvbnN0LnRzIiwgInNyYy9TZXR0aW5nVGFiLnRzIiwgInNyYy91dGlscy50cyIsICJzcmMvU3VnZ2VzdGVyLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBQbHVnaW4gfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgREVGQVVMVF9TRVRUSU5HUyB9IGZyb20gXCIuL2NvbnN0XCI7XHJcbmltcG9ydCB7IFNldHRpbmdzIH0gZnJvbSBcIi4vaW50ZXJmYWNlc1wiO1xyXG5pbXBvcnQgeyBTZXR0aW5nVGFiIH0gZnJvbSBcIi4vU2V0dGluZ1RhYlwiO1xyXG5pbXBvcnQgeyBDb2RlYmxvY2tTdWdnZXN0ZXIgfSBmcm9tIFwiLi9TdWdnZXN0ZXJcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENDUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcclxuXHRzZXR0aW5nczogU2V0dGluZ3M7XHJcblxyXG5cdGFzeW5jIG9ubG9hZCgpIHtcclxuXHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XHJcblx0XHR0aGlzLmFkZFNldHRpbmdUYWIobmV3IFNldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcclxuXHJcblx0XHR0aGlzLnJlZ2lzdGVyRWRpdG9yU3VnZ2VzdChuZXcgQ29kZWJsb2NrU3VnZ2VzdGVyKHRoaXMpKTtcclxuXHR9XHJcblxyXG5cdG9udW5sb2FkKCkge31cclxuXHJcblx0YXN5bmMgbG9hZFNldHRpbmdzKCkge1xyXG5cdFx0dGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oXHJcblx0XHRcdHt9LFxyXG5cdFx0XHRERUZBVUxUX1NFVFRJTkdTLFxyXG5cdFx0XHRhd2FpdCB0aGlzLmxvYWREYXRhKClcclxuXHRcdCk7XHJcblx0fVxyXG5cclxuXHRhc3luYyBzYXZlU2V0dGluZ3MoKSB7XHJcblx0XHRhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xyXG5cdH1cclxufVxyXG4iLCAiaW1wb3J0IHsgU2V0dGluZ3MgfSBmcm9tIFwiLi9pbnRlcmZhY2VzXCI7XHJcblxyXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogU2V0dGluZ3MgPSB7XHJcblx0Y3VzdG9tVHlwZXM6IFtdLFxyXG59O1xyXG4iLCAiaW1wb3J0IHsgQXBwLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCBDQ1BsdWdpbiBmcm9tIFwiLi9tYWluXCI7XHJcbmltcG9ydCB7IHNwbGl0QW5kVHJpbSB9IGZyb20gXCIuL3V0aWxzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xyXG5cdHBsdWdpbjogQ0NQbHVnaW47XHJcblxyXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IENDUGx1Z2luKSB7XHJcblx0XHRzdXBlcihhcHAsIHBsdWdpbik7XHJcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuXHR9XHJcblxyXG5cdGRpc3BsYXkoKTogdm9pZCB7XHJcblx0XHRsZXQgeyBjb250YWluZXJFbCwgcGx1Z2luIH0gPSB0aGlzO1xyXG5cdFx0Y29uc3QgeyBzZXR0aW5ncyB9ID0gcGx1Z2luO1xyXG5cdFx0Y29udGFpbmVyRWwuZW1wdHkoKTtcclxuXHJcblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuXHRcdFx0LnNldE5hbWUoXCJDdXN0b20gQ29kZWJsb2Nrc1wiKVxyXG5cdFx0XHQuc2V0RGVzYyhcclxuXHRcdFx0XHRcIkEgY29tbWEtc2VwYXJhdGVkIGxpc3Qgb2YgY29kZWJsb2NrcyB0eXBlcyB0byBzdWdnZXN0IChhc2lkZSBmcm9tIHRob3NlIGFkZGVkIGJ5IHlvdXIgcGx1Z2lucykuXCJcclxuXHRcdFx0KVxyXG5cdFx0XHQuYWRkVGV4dCgodGV4dCkgPT4ge1xyXG5cdFx0XHRcdHRleHQuc2V0VmFsdWUoc2V0dGluZ3MuY3VzdG9tVHlwZXMuam9pbihcIiwgXCIpKTtcclxuXHRcdFx0XHR0ZXh0LmlucHV0RWwub25ibHVyID0gYXN5bmMgKCkgPT4ge1xyXG5cdFx0XHRcdFx0Y29uc3QgdmFsdWUgPSB0ZXh0LmdldFZhbHVlKCk7XHJcblx0XHRcdFx0XHRzZXR0aW5ncy5jdXN0b21UeXBlcyA9IHNwbGl0QW5kVHJpbSh2YWx1ZSk7XHJcblx0XHRcdFx0XHRhd2FpdCBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0fTtcclxuXHRcdFx0fSk7XHJcblx0fVxyXG59XHJcbiIsICJleHBvcnQgY29uc3Qgc3BsaXRBbmRUcmltID0gKGZpZWxkczogc3RyaW5nKTogc3RyaW5nW10gPT4ge1xyXG5cdGlmICghZmllbGRzIHx8IGZpZWxkcyA9PT0gXCJcIikgcmV0dXJuIFtdO1xyXG5cdGVsc2UgcmV0dXJuIGZpZWxkcy5zcGxpdChcIixcIikubWFwKChzdHIpID0+IHN0ci50cmltKCkpO1xyXG59O1xyXG4iLCAiaW1wb3J0IHtcclxuXHRFZGl0b3IsXHJcblx0RWRpdG9yUG9zaXRpb24sXHJcblx0RWRpdG9yU3VnZ2VzdCxcclxuXHRFZGl0b3JTdWdnZXN0Q29udGV4dCxcclxuXHRFZGl0b3JTdWdnZXN0VHJpZ2dlckluZm8sXHJcblx0TWFya2Rvd25QcmV2aWV3UmVuZGVyZXIsXHJcblx0VEZpbGUsXHJcbn0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB0eXBlIEJDUGx1Z2luIGZyb20gXCIuL21haW5cIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBDb2RlYmxvY2tTdWdnZXN0ZXIgZXh0ZW5kcyBFZGl0b3JTdWdnZXN0PHN0cmluZz4ge1xyXG5cdHBsdWdpbjogQkNQbHVnaW47XHJcblxyXG5cdGNvbnN0cnVjdG9yKHBsdWdpbjogQkNQbHVnaW4pIHtcclxuXHRcdHN1cGVyKHBsdWdpbi5hcHApO1xyXG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcblx0fVxyXG5cclxuXHRvblRyaWdnZXIoXHJcblx0XHRjdXJzb3I6IEVkaXRvclBvc2l0aW9uLFxyXG5cdFx0ZWRpdG9yOiBFZGl0b3IsXHJcblx0XHRfOiBURmlsZVxyXG5cdCk6IEVkaXRvclN1Z2dlc3RUcmlnZ2VySW5mbyB8IG51bGwge1xyXG5cdFx0Y29uc3Qgc3ViID0gZWRpdG9yLmdldExpbmUoY3Vyc29yLmxpbmUpLnN1YnN0cmluZygwLCBjdXJzb3IuY2gpO1xyXG5cdFx0Y29uc3QgbWF0Y2ggPSBzdWIubWF0Y2goL15gYGAoLiopJC8pPy5bMV07XHJcblxyXG5cdFx0aWYgKG1hdGNoICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0cmV0dXJuIHtcclxuXHRcdFx0XHRzdGFydDoge1xyXG5cdFx0XHRcdFx0Y2g6IHN1Yi5sYXN0SW5kZXhPZihtYXRjaCksXHJcblx0XHRcdFx0XHRsaW5lOiBjdXJzb3IubGluZSxcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdGVuZDogY3Vyc29yLFxyXG5cdFx0XHRcdHF1ZXJ5OiBtYXRjaCxcclxuXHRcdFx0fTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gbnVsbDtcclxuXHR9XHJcblxyXG5cdGdldFN1Z2dlc3Rpb25zID0gKGNvbnRleHQ6IEVkaXRvclN1Z2dlc3RDb250ZXh0KSA9PiB7XHJcblx0XHRjb25zdCB7IHF1ZXJ5IH0gPSBjb250ZXh0O1xyXG5cdFx0Y29uc3QgZnJvbVBsdWdpbnMgPSBPYmplY3Qua2V5cyhcclxuXHRcdFx0Ly9AdHMtaWdub3JlXHJcblx0XHRcdE1hcmtkb3duUHJldmlld1JlbmRlcmVyLmNvZGVCbG9ja1Bvc3RQcm9jZXNzb3JzXHJcblx0XHQpO1xyXG5cdFx0cmV0dXJuIFsuLi50aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21UeXBlcywgLi4uZnJvbVBsdWdpbnNdLmZpbHRlcihcclxuXHRcdFx0KHN1ZykgPT4gc3VnLmluY2x1ZGVzKHF1ZXJ5KVxyXG5cdFx0KTtcclxuXHR9O1xyXG5cclxuXHRyZW5kZXJTdWdnZXN0aW9uKHN1Z2dlc3Rpb246IHN0cmluZywgZWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcblx0XHRlbC5jcmVhdGVEaXYoe1xyXG5cdFx0XHR0ZXh0OiBzdWdnZXN0aW9uLFxyXG5cdFx0XHRjbHM6IFwiY29kZWJsb2NrLXN1Z2dlc3Rpb25cIixcclxuXHRcdH0pO1xyXG5cdH1cclxuXHJcblx0YWRkTGluZUJyZWFrKGVuZDogRWRpdG9yUG9zaXRpb24sIGVkOiBFZGl0b3IpIHtcclxuXHRcdGNvbnN0IG5leHRMaW5lID0gZWQuZ2V0TGluZShlbmQubGluZSArIDEpO1xyXG5cdFx0Y29uc29sZS5sb2cobmV4dExpbmUpO1xyXG5cdFx0cmV0dXJuIG5leHRMaW5lID09PSBcImBgYFwiIHx8IG5leHRMaW5lID09PSBcIlwiIHx8IG5leHRMaW5lID09PSBcIlxcblwiXHJcblx0XHRcdD8gXCJcXG5cXG5cIlxyXG5cdFx0XHQ6IFwiXCI7XHJcblx0fVxyXG5cclxuXHRzZWxlY3RTdWdnZXN0aW9uKHN1Z2dlc3Rpb246IHN0cmluZyk6IHZvaWQge1xyXG5cdFx0Y29uc3QgeyBjb250ZXh0LCBhZGRMaW5lQnJlYWsgfSA9IHRoaXM7XHJcblx0XHRpZiAoY29udGV4dCkge1xyXG5cdFx0XHRjb25zdCB7IHN0YXJ0LCBlbmQsIGVkaXRvciB9ID0gY29udGV4dDtcclxuXHRcdFx0Y29uc3QgcmVwbGFjZW1lbnQgPSBgXFxgXFxgXFxgJHtzdWdnZXN0aW9ufSR7YWRkTGluZUJyZWFrKFxyXG5cdFx0XHRcdGVuZCxcclxuXHRcdFx0XHRlZGl0b3JcclxuXHRcdFx0KX1gO1xyXG5cclxuXHRcdFx0ZWRpdG9yLnJlcGxhY2VSYW5nZShyZXBsYWNlbWVudCwgeyBjaDogMCwgbGluZTogc3RhcnQubGluZSB9LCBlbmQpO1xyXG5cdFx0XHRlZGl0b3Iuc2V0Q3Vyc29yKHsgY2g6IDAsIGxpbmU6IGVuZC5saW5lICsgMSB9KTtcclxuXHRcdH1cclxuXHR9XHJcbn1cclxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FB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
